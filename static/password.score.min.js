function Keyboard(a,b){this.keyboard=a,this.averageNeighbours=b,this.areAdjacent=function(c,a){if(c in this.keyboard)for(var b=0;b<this.keyboard[c].length;b++)if(null!==this.keyboard[c][b]&&0<=this.keyboard[c][b].indexOf(a))return!0;return!1}}function Score(a){this.password=a}Score.prototype={constructor:Score,LOWER:26,UPPER:26,NUMBER:10,PUNCTUATION:34,OTHER:34,DAYS:31,MONTHS:31,YEARS:2e3,sequences:{lower:"abcdefghijklmnopqrstuvwxyz",numbers:"01234567890"},leet:{1:["i","l"],2:["n","r","z"],3:["e"],4:["a"],5:["s"],6:["g"],7:["t"],8:["b"],9:["g","o"],0:["o"],"@":["a"],"(":["c"],"[":["c"],"<":["c"],"&":["g"],"!":["i"],"|":["i","l"],"?":["n","r"],$:["s"],"+":["t"],"%":["x"]},regex:{repetition:{single:/(.)\1+/g,group:/(..+)\1+/g},date:{DMY:/(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])([\- \/.])?([0-9]{2})/g,DMYY:/(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])([\- \/.])?([0-9]{4})/g,MDY:/(0?[1-9]|1[012])([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?([0-9]{2})/g,MDYY:/(0?[1-9]|1[012])([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?([0-9]{4})/g,YDM:/([0-9]{2})([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])/g,YYDM:/([0-9]{4})([\- \/.])?(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])/g,YMD:/([0-9]{2})([\- \/.])?(0?[1-9]|1[012])([\- \/.])?(([0-9]{2})?[0-9]{2})(0?[1-9]|[12][0-9]|3[01])/g,YYMD:/([0-9]{4})([\- \/.])?(0?[1-9]|1[012])([\- \/.])?(([0-9]{2})?[0-9]{2})(0?[1-9]|[12][0-9]|3[01])/g,DM:/(0?[1-9]|[12][0-9]|3[01])([\- \/.])?(0?[1-9]|1[012])/g,MY:/(0?[1-9]|1[012])([\- \/.])?([0-9]{2})/g,MYY:/(0?[1-9]|1[012])([\- \/.])?([0-9]{4})/g},number:/[0-9]+/,numberOnly:/^[0-9]+$/,punctuation:/[\^°!"§\$%&\/\(\)=\?\\\.:,;\-_#'\+~\*<>\|\[\]\{\}`´]+/,punctuationOnly:/^[\^°!"§\$%&\/\(\)=\?\\\.:,;\-_#'\+~\*<>\|\[\]\{\}`´]+$/,lower:/[a-z]+/,lowerOnly:/^[a-z]+$/,upper:/[A-Z]+/,upperOnly:/^[A-Z]+$/,upperFirst:/^[A-Z]+[A-Za_z]*$/,upperFirstOnly:/^[A-Z]{1}[a-z]+$/,other:/[^\^°!"§\$%&\/\(\)=\?\\\.:,;\-_#'\+~\*<>\|\[\]\{\}`´0-9a-zA-Z]+/,otherOnly:/^[^\^°!"§\$%&\/\(\)=\?\\\.:,;\-_#'\+~\*<>\|\[\]\{\}`´0-9a-zA-Z]+$/},keyboards:{QWERTZ:new Keyboard({"^":[null,null,null,"^\xB0","1!",null,null],"°":[null,null,null,"^\xB0","1!",null,null],1:[null,null,"^\xB0","1!","2\"",null,"qQ@"],"!":[null,null,"^\xB0","1!","2\"",null,"qQ@"],2:[null,null,"1!","2\"","3\xA7","qQ@","wW"],'"':[null,null,"1!","2\"","3\xA7","qQ@","wW"],3:[null,null,"2\"","3\xA7","4$","wW","eE\u20AC"],"§":[null,null,"2\"","3\xA7","4$","wW","eE\u20AC"],4:[null,null,"3\xA7","4$","5%","eE\u20AC","rR"],$:[null,null,"3\xA7","4$","5%","eE\u20AC","rR"],5:[null,null,"4$","5%","6&","rR","tT"],"%":[null,null,"4$","5%","6&","rR","tT"],6:[null,null,"5%","6&","7/{","tT","yY"],"&":[null,null,"5%","6&","7/{","tT","yY"],7:[null,null,"6&","7/{","8([","yY","uU"],"/":[null,null,"6&","7/{","8([","yY","uU"],"{":[null,null,"6&","7/{","8([","yY","uU"],8:[null,null,"7/{","8([","9)]","uU","iI"],"(":[null,null,"7/{","8([","9)]","uU","iI"],"[":[null,null,"7/{","8([","9)]","uU","iI"],9:[null,null,"8([","9)]","0=}","iI","oO"],")":[null,null,"8([","9)]","0=}","iI","oO"],"]":[null,null,"8([","9)]","0=}","iI","oO"],0:[null,null,"9)]","0=}","\xDF?\\","oO","pP"],"=":[null,null,"9)]","0=}","\xDF?\\","oO","pP"],"}":[null,null,"9)]","0=}","\xDF?\\","oO","pP"],ß:[null,null,"0=}","\xDF?\\","\xB4`","pP","\xFC\xDC"],"?":[null,null,"0=}","\xDF?\\","\xB4`","pP","\xFC\xDC"],"\\":[null,null,"0=}","\xDF?\\","\xB4`","pP","\xFC\xDC"],"`":[null,null,"\xDF?\\","\xB4`",null,"\xFC\xDC","+*~"],"´":[null,null,"\xDF?\\","\xB4`",null,"\xFC\xDC","+*~"],q:["1!","2\"",null,"qQ@","wW",null,"aA"],Q:["1!","2\"",null,"qQ@","wW",null,"aA"],"@":["1!","2\"",null,"qQ@","wW",null,"aA"],w:["2\"","3\xA7","qQ@","wW","eE\u20AC","aA","sS"],W:["2\"","3\xA7","qQ@","wW","eE\u20AC","aA","sS"],e:["3\xA7","4$","wW","eE\u20AC","rR","sS","dD"],E:["3\xA7","4$","wW","eE\u20AC","rR","sS","dD"],"€":["3\xA7","4$","wW","eE\u20AC","rR","sS","dD"],r:["4$","5%","eE\u20AC","rR","tT","dD","fF"],R:["4$","5%","eE\u20AC","rR","tT","dD","fF"],t:["5%","6&","rR","tT","zZ","fF","gG"],T:["5%","6&","rR","tT","zZ","fF","gG"],z:["6&","7/{","tT","zZ","uU","gG","hH"],Z:["6&","7/{","tT","zZ","uU","gG","hH"],u:["7/{","8([","zZ","uU","iI","hH","jJ"],U:["7/{","8([","zZ","uU","iI","hH","jJ"],i:["8([","9)]","uU","iI","oO","jJ","kK"],I:["8([","9)]","uU","iI","oO","jJ","kK"],o:["9)]","0=}","iI","oO","pP","kK","lL"],O:["9)]","0=}","iI","oO","pP","kK","lL"],p:["0=}","\xDF?\\","oO","pP","\xFC\xDC","lL","\xF6\xD6"],P:["0=}","\xDF?\\","oO","pP","\xFC\xDC","lL","\xF6\xD6"],ü:["\xDF?\\","\xB4`","pP","\xFC\xDC","+*~","\xF6\xD6","\xE4\xC4"],Ü:["\xDF?\\","\xB4`","pP","\xFC\xDC","+*~","\xF6\xD6","\xE4\xC4"],"+":["\xB4``",null,"\xFC\xDC","+*~",null,"\xE4\xC4","'#"],"*":["\xB4``",null,"\xFC\xDC","+*~",null,"\xE4\xC4","'#"],"~":["\xB4``",null,"\xFC\xDC","+*~",null,"\xE4\xC4","'#"],a:["qQ@","wW",null,"aA","sS","<>|","yY"],A:["qQ@","wW",null,"aA","sS","<>|","yY"],s:["wW","eE\u20AC","aA","sS","dD","yY","xX"],S:["wW","eE\u20AC","aA","sS","dD","yY","xX"],d:["eE\u20AC","rR","sS","dD","fF","xX","cC"],D:["eE\u20AC","rR","sS","dD","fF","xX","cC"],f:["rR","tT","dD","fF","gG","cC","vV"],F:["rR","tT","dD","fF","gG","cC","vV"],g:["tT","zZ","fF","gG","hH","vV","bB"],G:["tT","zZ","fF","gG","hH","vV","bB"],h:["zZ","uU","gG","hH","jJ","bB","nN"],H:["zZ","uU","gG","hH","jJ","bB","nN"],j:["uU","iI","hH","jJ","kK","nN","mM"],J:["uU","iI","hH","jJ","kK","nN","mM"],k:["iI","oO","jJ","kK","lL","mM",",;"],K:["iI","oO","jJ","kK","lL","mM",",;"],l:["oO","pP","kK","lL","\xF6\xD6",",;",".:"],L:["oO","pP","kK","lL","\xF6\xD6",",;",".:"],ö:["pP","\xFC\xDC","lL","\xF6\xD6","\xE4\xC4",".:","-_"],Ö:["pP","\xFC\xDC","lL","\xF6\xD6","\xE4\xC4",".:","-_"],ä:["\xFC\xDC","+*~","\xF6\xD6","\xE4\xC4","#'","-_",null],Ä:["\xFC\xDC","+*~","\xF6\xD6","\xE4\xC4","#'","-_",null],"#":["+*~",null,"\xE4\xC4","#'",null,null,null],"'":["+*~",null,"\xE4\xC4","#'",null,null,null],"<":[null,"aA",null,"<>|","yY",null,null],">":[null,"aA",null,"<>|","yY",null,null],"|":[null,"aA",null,"<>|","yY",null,null],y:["aA","sS","<>|","yY","xX",null,null],Y:["aA","sS","<>|","yY","xX",null,null],x:["sS","dD","yY","xX","cC",null,null],X:["sS","dD","yY","xX","cC",null,null],c:["dD","fF","xX","cC","vV",null,null],C:["dD","fF","xX","cC","vV",null,null],v:["fF","gG","cC","vV","bB",null,null],V:["fF","gG","cC","vV","bB",null,null],b:["gG","hH","vV","bB","nN",null,null],B:["gG","hH","vV","bB","nN",null,null],n:["hH","jJ","bB","nN","mM",null,null],N:["hH","jJ","bB","nN","mM",null,null],m:["jJ","kK","nN","mM",",;",null,null],M:["jJ","kK","nN","mM",",;",null,null],",":["kK","lL","mM",",;",".:",null,null],";":["kK","lL","mM",",;",".:",null,null],".":["lL","\xF6\xD6",",;",".:","-_",null,null],":":["lL","\xF6\xD6",",;",".:","-_",null,null],"-":["\xF6\xD6","\xE4",".:","-_",null,null,null],_:["\xF6\xD6","\xE4",".:","-_",null,null,null]},4.571428571),QWERTY:new Keyboard({"~":[null,null,null,"~`","1!",null,null],"`":[null,null,null,"~`","1!",null,null],1:[null,null,"`~","1!","2@",null,"qQ"],"!":[null,null,"`~","1!","2@",null,"qQ"],2:[null,null,"1!","2@","3#","qQ","wW"],"@":[null,null,"1!","2@","3#","qQ","wW"],3:[null,null,"2@","3#","4$","wW","eE"],"#":[null,null,"2@","3#","4$","wW","eE"],4:[null,null,"3#","4$","5%","eE","rR"],$:[null,null,"3#","4$","5%","eE","rR"],5:[null,null,"4$","5%","6^","rR","tT"],"%":[null,null,"4$","5%","6^","rR","tT"],6:[null,null,"5%","6^","7&","tT","yY"],"^":[null,null,"5%","6^","7&","tT","yY"],7:[null,null,"6^","7&","8*","yY","uU"],"&":[null,null,"6^","7&","8*","yY","uU"],8:[null,null,"7&","8*","9(","uU","iI"],"*":[null,null,"7&","8*","9(","uU","iI"],9:[null,null,"8*","9(","0)","iI","oO"],"(":[null,null,"8*","9(","0)","iI","oO"],0:[null,null,"9(","0)","-_","oO","pP"],")":[null,null,"9(","0)","-_","oO","pP"],"-":[null,null,"0)","-_","=+","pP","[{"],_:[null,null,"0)","-_","=+","pP","[{"],"=":[null,null,"-_","=+","\\|","{[","}]"],"+":[null,null,"-_","=+","\\|","{[","}]"],"\\":[null,null,"=+","\\|",null,"}]",null],"|":[null,null,"=+","\\|",null,"}]",null],q:["1!","2@",null,"qQ","wW",null,"aA"],Q:["1!","2@",null,"qQ","wW",null,"aA"],w:["2@","3#","qQ","wW","eE","aA","sS"],W:["2@","3#","qQ","wW","eE","aA","sS"],e:["3#","4$","wW","eE","rR","sS","dD"],E:["3#","4$","wW","eE","rR","sS","dD"],r:["4$","5%","eE","rR","tT","dD","fF"],R:["4$","5%","eE","rR","tT","dD","fF"],t:["5%","6^","rR","tT","yY","fF","gG"],T:["5%","6^","rR","tT","yY","fF","gG"],y:["6^","7&","tT","yY","uU","gG","hH"],Y:["6^","7&","tT","yY","uU","gG","hH"],u:["7&","8*","yY","uU","iI","hH","jJ"],U:["7&","8*","yY","uU","iI","hH","jJ"],i:["8*","9(","uU","iI","oO","jJ","kK"],I:["8*","9(","uU","iI","oO","jJ","kK"],o:["9(","0)","iI","oO","pP","kK","lL"],O:["9(","0)","iI","oO","pP","kK","lL"],p:["0)","-_","oO","pP","[{","lL",":;"],P:["0)","-_","oO","pP","[{","lL",":;"],"[":["-_","=+","pP","[{","]}",":;","'\""],"{":["-_","=+","pP","[{","]}",":;","'\""],"]":["=+","\\|","[{","]}",null,"'\"",null],"}":["=+","\\|","[{","]}",null,"'\"",null],a:["qQ","wW",null,"aA","sS",null,"zZ"],A:["qQ","wW",null,"aA","sS",null,"zZ"],s:["wW","eE","aA","sS","dD","zZ","xX"],S:["wW","eE","aA","sS","dD","zZ","xX"],d:["eE","rR","sS","dD","fF","xX","cC"],D:["eE","rR","sS","dD","fF","xX","cC"],f:["rR","tT","dD","fF","gG","cC","vV"],F:["rR","tT","dD","fF","gG","cC","vV"],g:["tT","yY","fF","gG","hH","vV","bB"],G:["tT","yY","fF","gG","hH","vV","bB"],h:["yY","uU","gG","hH","jJ","bB","nN"],H:["yY","uU","gG","hH","jJ","bB","nN"],j:["uU","iI","hH","jJ","kK","nN","mM"],J:["uU","iI","hH","jJ","kK","nN","mM"],k:["iI","oO","jJ","kK","lL","mM",",;"],K:["iI","oO","jJ","kK","lL","mM",",;"],l:["oO","pP","kK","lL",":;",",<",".>"],L:["oO","pP","kK","lL",":;",",<",".>"],":":["pP","[{","lL",":;","'\"",".>","?/"],";":["pP","[{","lL",":;","'\"",".>","?/"],"'":["[{","]}",":;","'\"",null,"?/",null],'"':["[{","]}",":;","'\"",null,"?/",null],z:["aA","sS",null,"zZ","xX",null,null],Z:["aA","sS",null,"zZ","xX",null,null],x:["sS","dD","zZ","xX","cC",null,null],X:["sS","dD","zZ","xX","cC",null,null],c:["dD","fF","xX","cC","vV",null,null],C:["dD","fF","xX","cC","vV",null,null],v:["fF","gG","cC","vV","bB",null,null],V:["fF","gG","cC","vV","bB",null,null],b:["gG","hH","vV","bB","nN",null,null],B:["gG","hH","vV","bB","nN",null,null],n:["hH","jJ","bB","nN","mM",null,null],N:["hH","jJ","bB","nN","mM",null,null],m:["jJ","kK","nN","mM",",<",null,null],M:["jJ","kK","nN","mM",",<",null,null],",":["kK","lL","mM",",<",".>",null,null],"<":["kK","lL","mM",",<",".>",null,null],".":["lL",":;",",<",".>","/?",null,null],">":["lL",":;",",<",".>","/?",null,null],"/":[":;","'\"",".>","/?",null,null,null],"?":[":;","'\"",".>","/?",null,null,null]},4.571428571),QWERTZNumpad:new Keyboard({0:["1","2",",",null],",":["3","0",null,null],1:["4",null,"2","0"],2:["5","1","3","0"],3:["3","2",null,","],4:["7",null,"5","1"],5:["8","4","6","2"],6:["9","5","6","2"],7:[null,null,"8","4"],8:["/","7","9","5"],9:["*","8","+","6"],"+":["-","9","6",null],"/":[null,null,"*","8"],"*":[null,"/","-","9"],"-":[null,"*",null,"+"]},3),QWERTYNumpad:new Keyboard({0:["1","2",",",null],",":["3","0",null,null],1:["4",null,"2","0"],2:["5","1","3","0"],3:["6","2",null,","],4:["7",null,"5","1"],5:["8","4","6","2"],6:["9","5","+","2"],7:[null,null,"8","4"],8:["/","7","9","5"],9:["*","8","+","6"],"+":["-","9","6",null],"/":[null,null,"*","8"],"*":[null,"/","-","9"],"-":[null,"*",null,"+"]},3)},cache:{clear:function(){for(var a in this)"set"!=a&&"clear"!==a&&(this[a]=void 0)},set:function(a,b){this[a]=b}},lg:function(a){return Math.log(a)/Math.log(2)},calculateAverageTimeToCrack:function(a,b){return .005*(.5*Math.pow(2,a))/b},calculateBruteForceEntropy:function(){var a=0,b=!1;this.regex.lower.test(this.password)&&(a+=this.LOWER,b=!0),this.regex.upper.test(this.password)&&(a+=this.UPPER,b=!0),this.regex.number.test(this.password)&&(a+=this.NUMBER,b=!0),this.regex.punctuation.test(this.password)&&(a+=this.PUNCTUATION,b=!0),this.regex.other.test(this.password)&&(a+=this.OTHER);var c=this.lg(a)*this.password.length;return this.cache.set("naiveEntropy",c),c},collectMatches:function(a,b){a=a===void 0?[]:a,b=!(b!==void 0)||b,!0===b&&this.options!==void 0&&(a=a.concat(this.options));for(var c,d=[],e=0;e<a.length;e++)if(c=[],!(!1 in a[e])){switch(a[e].type){case"dictionary":if("dictionary"in a[e]&&(c=this.collectDictionaryMatches(a[e].dictionary),"leet"in a[e]&&!0===a[e].leet)){var f=this.collectLeetSpeakMatches(a[e].dictionary);c=c.concat(f)}break;case"keyboard":"keyboard"in a[e]&&(c=this.collectKeyboardMatches(a[e].keyboard));break;case"repetition":c=this.collectRepetitionMatches();break;case"sequences":c=this.collectSequenceMatches();break;case"dates":c=this.collectDateMatches();}"key"in a[e]&&this.cache.set(a[e].key,c),d=d.concat(c)}return d},calculateEntropyScore:function(a,b){for(var c=this.collectMatches(a,b),d=[],e=[],f=this.calculateBruteForceEntropy(this.password),g=0;g<this.password.length;g++){c[c.length]={pattern:this.password[g],entropy:this.calculateBruteForceEntropy(this.password[g]),start:g,end:g,type:"letter"},d[g]=Number.POSITIVE_INFINITY;for(var h=0;h<c.length;h++){var k=c[h].start,l=c[h].end;if(l===g){var f=c[h].entropy;0<k&&(f+=d[k-1]),f<d[g]&&(d[g]=f,e[g]=c[h])}}}for(var m=[],g=this.password.length-1;0<=g;)e[g]?(m[m.length]=e[g],g=e[g].start-1):g--;return this.cache.set("minimumMatches",m),this.cache.set("entropy",d[this.password.length-1]),d[this.password.length-1]},collectDictionaryMatches:function(a){for(var b=[],c=0;c<this.password.length;c++)for(var d=c;d<this.password.length;d++){var e=this.password.substring(c,d+1),f=e.toLowerCase(),g=this.getReversedString(f);f in a&&a[f]&&(b[b.length]={pattern:e,entropy:this.calculateDictionaryEntropy(e,f,a[f]),start:c,end:d,type:"dictionary"}),g in a&&a[g]&&(b[b.length]={pattern:e,entropy:this.calculateReversedDictionaryEntropy(e,f,a[g]),start:c,end:d,type:"dictionary"})}return b},calculateDictionaryEntropy:function(a,b,c){return this.regex.lower.test(a)&&this.regex.upper.test(a)?this.regex.upperFirstOnly.test(a)?this.lg(c)+1:this.lg(c)+a.length:this.lg(c)},calculateReversedDictionaryEntropy:function(a,b,c){return this.calculateDictionaryEntropy(a,b,c)+1},collectLeetSpeakMatches:function(a){for(var b=[],c=this.collectLeetSpeakSubstitutions(this.password),d=0;d<c.length;d++)for(var e=0;e<c[d].length;e++)for(var f=e;f<c[d].length;f++){var g=c[d].substring(e,f+1),h=g.toLowerCase(),l=this.getReversedString(h),m=this.password.substring(e,f+1);h in a&&a[h]&&(b[b.length]={pattern:m,entropy:this.calculateLeetSpeakEntropy(this.password.substring(e,f+1),h,a[h]),start:e,end:f,type:"leet"}),l in a&&a[h]&&(b[b.length]={pattern:m,entropy:this.calculateReversedLeetSpeakEntropy(this.password.substring(e,f+1),h,a[h]),start:e,end:f,type:"leet"})}return b},calculateLeetSpeakEntropy:function(a,b,c){var d=1;for(var e in this.leet)0<=a.indexOf(e)&&(d*=this.leet[e].length+1);return this.calculateDictionaryEntropy(a,b,c)+this.lg(d)},calculateReversedLeetSpeakEntropy:function(a,b,c){return this.calculateLeetSpeakEntropy(a,b,c)+1},collectLeetSpeakSubstitutions:function(){var a={};for(var b in this.leet)0<=this.password.indexOf(b)&&(a[b]=this.leet[b]);var c=function(b){if(b[0]in a){if(1===b.length)return a[b[0]];for(var d=c(b.substring(1,b.length)),e=[],f=0;f<d.length;f++)for(var g=0;g<a[b[0]].length;g++)e[e.length]=a[b[0]][g]+d[f];return e}if(1===b.length)return[b[0]];for(var d=c(b.substring(1,b.length)),e=[],f=0;f<d.length;f++)e[e.length]=b[0]+d[f];return e};return c(this.password)},collectKeyboardMatches:function(a){for(var b=[],c=this.password[0],d=0,e=0,f=0;f<this.password.length-1;f++)a.areAdjacent(this.password[f],this.password[f+1])?(c+=this.password[f+1],this.password[f+1]!==this.password[f]&&d++):1<c.length?(b[b.length]={pattern:c,entropy:this.calculateKeyboardEntropy(c,d,a),start:e,end:f,type:"keyboard"},c=this.password[f+1],d=0,e=f+1):(c=this.password[f+1],d=0,e=f+1);return 1<c.length&&(b[b.length]={pattern:c,entropy:this.calculateKeyboardEntropy(c,d,a),start:e,end:this.password.length-1,type:"keyboard"}),b},calculateKeyboardEntropy:function(a,b,c){var d=1;return this.regex.lower.test(a[0])?d=this.LOWER:this.regex.upper.test(a[0])?d=this.UPPER:this.regex.number.test(a[0])?d=this.NUMBER:this.regex.punctuation.test(a[0])&&(d=this.PUNCTUATION),this.lg(d)+b*this.lg(c.averageNeighbours)},collectRepetitionMatches:function(){for(var a=[],b=this.password.match(this.regex.repetition.single)||[],c=0;c<b.length;c++)a[a.length]={pattern:b[c],entropy:this.calculateSingleRepetitionEntropy(b[c]),start:this.password.indexOf(b[c]),end:this.password.indexOf(b[c])+b[c].length-1,type:"repetition"};for(var d=this.password.match(this.regex.repetition.group)||[],c=0;c<d.length;c++)a[a.length]={pattern:d[c],entropy:this.calculateGroupRepetitionEntropy(d[c]),start:this.password.indexOf(d[c]),end:this.password.indexOf(d[c])+d[c].length-1,type:"repetition"};return a},calculateSingleRepetitionEntropy:function(a){return this.regex.number.test(a)?this.lg(this.NUMBER*a.length):this.regex.lower.test(a)||this.regex.upper.test(a)?this.lg(this.LOWER*a.length):this.regex.punctuation.test(a)?this.lg(this.PUNCTUATION*a.length):this.calculateBruteForceEntropy(a)},calculateGroupRepetitionEntropy:function(a){for(var b=this.regex.repetition.group.exec(a),c=a.length;null!==b;)c=b[1].length,b=this.regex.repetition.group.exec(b[1]);var d=0;return this.regex.number.test(a)&&(d+=this.NUMBER),(this.regex.lower.test(a)||this.regex.upper.test(a))&&(d+=this.LOWER),this.regex.punctuation.test(a)&&(d+=this.PUNCTUATION),this.lg(d*c)},collectSequenceMatches:function(){for(var a="",b="",c="",d="",e=0;e<this.password.length;e++)for(var f=e+2;f<=this.password.length;f++){var g=this.password.substring(e,f),h=g.toLowerCase(),k=this.getReversedString(h);0!==h.length&&(0<=this.sequences.lower.indexOf(h)&&h.length>a.length&&(a=g),0<=this.sequences.lower.indexOf(k)&&h.length>b.length&&(b=g),0<=this.sequences.numbers.indexOf(h)&&h.length>c.length&&(c=g),0<=this.sequences.numbers.indexOf(k)&&h.length>c.length&&(d=g))}var l=[];return 0<a.length&&(l[l.length]={pattern:a,entropy:this.calculateSequenceEntropy(a),start:this.password.indexOf(a),end:this.password.indexOf(a)+a.length-1,type:"sequence"}),0<b.length&&(l[l.length]={pattern:b,entropy:this.calculateSequenceEntropy(b),start:this.password.indexOf(b),end:this.password.indexOf(b)+b.length-1,type:"sequence"}),0<c.length&&(l[l.length]={pattern:c,entropy:this.calculateSequenceEntropy(c),start:this.password.indexOf(c),end:this.password.indexOf(c)+c.length-1,type:"sequence"}),0<d.length&&(l[l.length]={pattern:d,entropy:this.calculateSequenceEntropy(d),start:this.password.indexOf(d),end:this.password.indexOf(d)+d.length-1,type:"sequence"}),l},calculateSequenceEntropy:function(a){if(this.regex.number.test(a))return this.lg(a.length*this.NUMBER);return this.regex.lowerOnly.test(a)?this.lg(a.length*this.LOWER):this.regex.upperOnly.test(a)?this.lg(a.length*this.LOWER):this.regex.upper.test(a)&&this.regex.upper.test(a)?this.lg(a.length*(this.LOWER+this.UPPER)):this.calculateBruteForceEntropy(a)},calculateReversedSequenceEntropy:function(a){return this.calculateSequenceEntropy(a)+1},collectDateMatches:function(){var a=[];for(var b in this.regex.date)for(var c=this.password.match(this.regex.date[b])||[],d=0;d<c.length;d++)if(0<c[d].length){var e=this.password.indexOf(c[d]);a[a.length]={pattern:c[d],entropy:this.calculateDateEntropy(c[d],b),start:e,end:e+c[d].length-1,type:"date"}}return a},calculateDateEntropy:function(a,b){switch(b){case"DMY":case"MDY":case"YDM":case"YMD":return this.lg(10*(10*(this.DAYS*this.MONTHS)));break;case"DMYY":case"MDYY":case"YYDM":case"YYMD":return this.lg(this.DAYS*this.MONTHS*this.YEARS);break;case"DM":return this.lg(this.DAYS*this.MONTHS);break;case"MY":return this.lg(10*(10*this.MONTHS));break;case"MYY":return this.lg(this.MONTHS*this.YEARS);}return this.calculateBruteForceEntropy(a)},getReversedString:function(a){return a.split("").reverse().join("")}};